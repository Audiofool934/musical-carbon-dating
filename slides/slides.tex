\documentclass[aspectratio=169, 10pt]{beamer}

% --- Theme & Colors ---
\usetheme{Madrid}
\usecolortheme{dolphin}
\usefonttheme{professionalfonts}

% --- Packages ---
\usepackage{bookmark}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{amsmath, amssymb}
\usepackage{hyperref}
\usepackage{ragged2e}
\usepackage{xcolor}
\usepackage{colortbl}

% --- Metadata ---
\title[Musical Carbon Dating]{Musical Carbon Dating}
\subtitle{A Statistical Feature Recognition Approach (1960-2020)}
\author[Group Project]{Group Presentation}
\institute[Data Science]{University Statistical Analysis Project}
\date{\today}

% --- Configuration ---
\setbeamertemplate{navigation symbols}{}
\setbeamerfont{caption}{size=\footnotesize}
\graphicspath{{../output/figures/}}

\begin{document}

% -----------------------------------------------------------------------------
% Title Slide
% -----------------------------------------------------------------------------
\begin{frame}
    \titlepage
\end{frame}

\begin{frame}
    \centering
    \includegraphics[width=0.9\textwidth]{logo.png}
\end{frame}

\begin{frame}{Table of Contents}
    \tableofcontents
\end{frame}

% -----------------------------------------------------------------------------
% Section 1: Introduction
% -----------------------------------------------------------------------------
\section{Overview \& Data}

\begin{frame}{The Research Question}
    \begin{block}{Feature Recognition}
        \centering
        \textit{"Can we determine the vintage of a musical recording purely from its acoustic properties?"}
    \end{block}
    
    \vspace{0.5cm}
    \textbf{Objective}: 
    To build a regression model that maps audio features to release year, quantifying the "Arrow of Time" in music production.
    
    \vspace{0.3cm}
    \textbf{Hypothesis}:
    Musical eras have distinct, quantifiable acoustic fingerprints (e.g., the "dryness" of 70s rock vs. the "compression" of 2000s pop).
\end{frame}

\begin{frame}{The Data: Spotify 600k Tracks}
    \textbf{Data Filtering Strategy}:
    \begin{itemize}
        \item \textbf{Source}: Spotify 600k Tracks Dataset (Kaggle).
        \item \textbf{Filter 1}: Timeframe $1960 \le T \le 2020$ (Modern Era).
        \item \textbf{Filter 2}: \texttt{popularity > 30} (Focus on culturally significant music).
        \item \textbf{Final Sample}: $N = \mathbf{250,971}$ tracks.
    \end{itemize}
    
    \vspace{0.5cm}
    \textbf{Validation Strategy}:
    \begin{itemize}
        \item \textbf{Random Split}: 80\% Training / 20\% Test.
        \item \textit{Rationale}: We are testing "feature recognition" (interpolating styles), not future forecasting (extrapolating time).
    \end{itemize}
\end{frame}

\begin{frame}{The Feature Set (p=13)}
    We utilized all 13 available audio features.
    
    \begin{columns}[t]
        \column{0.33\textwidth}
        \textbf{Physical Features}
        \begin{enumerate}
            \item \texttt{Loudness} (dB)
            \item \texttt{Tempo} (BPM)
            \item \texttt{Duration} (ms)
        \end{enumerate}
        
        \column{0.33\textwidth}
        \textbf{Musical Features}
        \begin{enumerate}
            \setcounter{enumi}{3}
            \item \texttt{Key} (0-11)
            \item \texttt{Mode} (Major/Minor)
            \item \texttt{Time Signature}
        \end{enumerate}
        
        \column{0.33\textwidth}
        \textbf{Perceptual Features}
        \begin{enumerate}
            \setcounter{enumi}{6}
            \item \texttt{Acousticness}
            \item \texttt{Danceability}
            \item \texttt{Energy}
            \item \texttt{Instrumentalness}
            \item \texttt{Liveness}
            \item \texttt{Speechiness}
            \item \texttt{Valence} (Positivity)
        \end{enumerate}
    \end{columns}
\end{frame}

% -----------------------------------------------------------------------------
% Section 2: Methodology Pipeline
% -----------------------------------------------------------------------------
\section{Methodology Pipeline}

\begin{frame}{The Regression Pipeline}
    We followed a rigorous 5-phase statistical workflow:
    \vspace{0.5cm}
    \begin{enumerate}
        \item \textbf{Phase I: Simple Linear Regression (SLR)}
        \textit{Hypothesis testing: The "Loudness War".}

        \item \textbf{Data Standardization}
        \textit{Z-Score Normalization ($x' = \frac{x-\mu}{\sigma}$) to ensure scale invariance.}
        
        \item \textbf{Phase II: Multiple Linear Regression (MLR)}
        \textit{Baseline model using all $p=13$ features.}
        
        \item \textbf{Phase III: The Diagnostic Audit} (Critical Step)
        \textit{Testing Linearity, Multicollinearity, Normality, and Homoscedasticity.}
        
        \item \textbf{Phase IV: Model Selection}
        \textit{Stepwise AIC vs LASSO comparison.}
        
        \item \textbf{Phase V: Refinement (WLS)}
        \textit{Weighted Least Squares to correct for Heteroscedasticity.}
    \end{enumerate}
\end{frame}

% -----------------------------------------------------------------------------
% Section 3: Analysis
% -----------------------------------------------------------------------------
\section{Phases I-III: Diagnostics}

\begin{frame}{Phase I: The "Loudness War" (SLR)}
    $$ Year_i = \beta_0 + \beta_{loud} \cdot Loudness_i + \varepsilon_i $$
    
    \begin{columns}
        \column{0.5\textwidth}
        \includegraphics[width=0.9\linewidth]{eda_trends_over_time.png}
        
        \column{0.5\textwidth}
        \textbf{Results}:
        \begin{itemize}
            \item $t$-stat: \textbf{159.4} (Highly Significant).
            \item $\beta_{loud} \approx 4.98$ years/dB (Standardized).
            \item $R^2 = 0.130$.
        \end{itemize}
        
        \vspace{0.3cm}
        \textbf{Conclusion}: 
        Tracks have consistently gotten louder, but Loudness alone explains only 14\% of the variance.
    \end{columns}
\end{frame}

\begin{frame}{Phase II: Multiple Linear Regression (Baseline)}
    $$ \mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon} $$
    
    \begin{itemize}
        \item \textbf{Algorithm}: Ordinary Least Squares (OLS) with all 13 features.
        \item \textbf{Result ($R^2$)}: \textbf{0.238}
        \item \textbf{RMSE}: 12.05 years.
    \end{itemize}
    
    \vspace{0.3cm}
    \begin{alertblock}{Why so low?}
       An $R^2$ of 0.3 suggests we are missing non-linear patterns or violating OLS assumptions. We initiated a \textbf{Diagnostic Audit}.
    \end{alertblock}
\end{frame}

\begin{frame}{Phase III: Diagnostic Audit (1/2)}
    \textbf{Test 1: Independence of Errors}
    \begin{itemize}
        \item \textbf{Method}: Durbin-Watson Statistic.
        \item \textbf{Result}: $DW \approx 2.001$. (Target = 2.0)
        \item \textbf{Finding}: \textcolor{green}{Assumption Met.} No autocorrelation. Each song is statistically unique.
    \end{itemize}
    
    \vspace{0.5cm}
    \textbf{Test 2: Multicollinearity}
    \begin{itemize}
        \item \textbf{Method}: Variance Inflation Factor (VIF).
        \item \textbf{Concern}: High correlation between Loudness and Energy ($r=0.74$).
        \item \textbf{Result}: Max VIF (Energy) = \textbf{3.62}. All VIFs $< 5.0$.
        \item \textbf{Finding}: \textcolor{green}{Assumption Met.} No severe multicollinearity.
    \end{itemize}
\end{frame}

\begin{frame}{Phase III: Diagnostic Audit (2/2)}
    \textbf{Test 3: Homoscedasticity (Constant Variance)}
    
    \begin{columns}
        \column{0.5\textwidth}
        \includegraphics[width=\linewidth]{error_by_era.png}
        
        \column{0.5\textwidth}
        \begin{itemize}
            \item \textbf{Visual}: Dispersed variance (Right) vs Tight variance (Left).
            \item \textbf{Insight}: "Stylistic Entropy". The definition of specific eras has blurred over time due to technology.
            \item \textbf{Statistic}: $\chi^2 = \mathbf{19,567}$ (Breusch-Pagan).
            \item \textbf{Conclusion}: Variance is expanding. OLS fails because it treats 1960 and 2020 as equally predictable.
        \end{itemize}
    \end{columns}
    
    \vspace{0.3cm}
    \textbf{Solution}: We must weight the model to trust the "consistent" eras more than the "chaotic" ones. \textbf{Enter WLS.}
\end{frame}

% -----------------------------------------------------------------------------
% Section 4: Solution
% -----------------------------------------------------------------------------
\section{Phases IV-V: Refinement}

\begin{frame}{Phase IV: Model Selection}
    We compared two methods to identify the "True" feature set:
    
    \begin{table}[]
        \centering
        \begin{tabular}{lll}
            \toprule
            \textbf{Method} & \textbf{Selected Features} & \textbf{Key Difference} \\
            \midrule
            Stepwise (AIC) & 12 Features & Dropped \texttt{Key} \\
            \rowcolor{green!10} LASSO ($L_1$) & \textbf{13 Features} & \textbf{Kept All Acoustic Features} \\
            \bottomrule
        \end{tabular}
    \end{table}
    
    \vspace{0.3cm}
    \textbf{Decision}: We utilized the full acoustic feature set.
    \begin{itemize}
        \item Removing variables offered negligible AIC improvement.
        \item Retaining subtle features (Key, Mode) ensures we capture harmonic evolution.
    \end{itemize}
\end{frame}

\begin{frame}{Phase V: Weighted Least Squares (WLS)}
    To cure Heteroscedasticity, we implemented WLS:
    $$ \min_{\beta} \sum_{i=1}^{n} w_i (y_i - \mathbf{x}_i^T \beta)^2, \quad \text{where } w_i \propto \frac{1}{\text{Var}(\varepsilon_i)} $$
    
    \begin{columns}
        \column{0.5\textwidth}
        \includegraphics[width=0.8\linewidth]{pred_vs_act_best_model_(wls)_predictions.png}
    
        \column{0.5\textwidth}
        \begin{alertblock}{What WLS Fixes}
            \begin{itemize}
                \item \textbf{Valid p-values} \& confidence intervals.
                \item \textbf{Efficient coefficient estimates}.
            \end{itemize}
        \end{alertblock}
        
        \vspace{0.3cm}
        \textbf{Metrics:}
        \begin{itemize}
            \item Weighted $R^2$: \textbf{0.763} (Trend Fit)
            \item F-statistic: $\mathbf{4.19 \times 10^4}$ (Highly Significant)
            \item Unweighted Test $R^2$: $\approx 0.24$ (Raw Data)
            \item Test \textbf{RMSE}: 12.05 years
            \item Test \textbf{MAE}: 9.31 years
        \end{itemize}
    \end{columns}
    
    \vspace{0.2cm}
    \footnotesize{\textit{Note: The jump to 0.77 reflects weighting down outliers, not miraculously predicting them. The raw prediction power remains similar to MLR (0.30).}}
\end{frame}

\begin{frame}{Phase VI-A: Technological Drivers ("The Sound of Efficiency")}
    \textbf{Regression reveals the impact of technology on composition ($p < 0.001$).}
    
    \begin{itemize}
        \item \textbf{The Loudness-Energy Paradox (Multicollinearity Insight)}:
        \begin{itemize}
            \item Mean \texttt{Loudness} has skyrocketed over time ($\beta_{loud} \approx +6.51$).
            \item Yet, \texttt{Energy}'s coefficient is \textbf{negative} ($\beta_{energy} \approx -1.20$) when controlling for Loudness.
            \item \textbf{Interpretation}: Modern tracks are "loud" due to compression (technological), not raw musical energy (compositional).
        \end{itemize}

        \item \textbf{The Attention Economy (Duration)}:
        \begin{itemize}
            \item Coefficient $\beta_{duration} \approx -0.89$ (Negative).
            \item Songs are getting statistically shorter, likely driven by streaming incentives and skipping behavior.
        \end{itemize}
        
        \item \textbf{Instrumentalness} ($\beta \approx +0.58$):
        \small{A shift towards beat-driven (Hip-Hop/EDM) production over vocal-centric ballads.}
    \end{itemize}
\end{frame}

\begin{frame}{Phase VI-B: Cultural Evolution ("The Mood of an Era")}
    \textbf{Applying Statistical Inference to Cultural Theory.}
    
    \begin{itemize}
        \item \textbf{The "Sad Banger" Phenomenon}:
        \begin{itemize}
            \item \textbf{Danceability} ($\beta \approx +3.86$): The single strongest predictor. Rhythm is the defining feature of modernity.
            \item \textbf{Valence} ($\beta \approx -4.14$): Optimism has collapsed.
            \item \textbf{Synthesis}: We are dancing more, but feeling less.
        \end{itemize}

        \item \textbf{The Acousticness Paradox (Ceteris Paribus)}:
        \begin{itemize}
            \item Raw Correlation: Negative ($r \approx -0.12$).
            \item WLS Coefficient: \textbf{Positive} ($\beta \approx +0.62$).
            \item \textbf{Discovery}: \textit{Controlling for Loudness}, modern music actually retains significant acoustic elements (Indie, Lo-Fi), hidden by the "Wall of Sound".
        \end{itemize}
    \end{itemize}
    
    \begin{alertblock}{Analytical Triumph}
       By using \textbf{Partial Regression Coefficients}, we uncovered trends (like the Acousticness reversal) that simple correlation would have missed.
    \end{alertblock}
\end{frame}

% -----------------------------------------------------------------------------
% Section 5: Applications
% -----------------------------------------------------------------------------
\section{Applications}

\begin{frame}{The Nostalgia Index}
    \textit{"One man's error is another man's feature."}
    
    We define the \textbf{Nostalgia Index} as the model's prediction error:
    $$ \text{Index} = | \hat{Y}_{predicted} - Y_{actual} | $$
    
    High index = A song that "sounds" like it belongs to a different era.
    
    \vspace{0.5cm}
    \textbf{Distribution Stats}:
    \begin{itemize}
        \item Mean: \textbf{9.31} yrs
        \item Median: \textbf{7.58} yrs
        \item Max: \textbf{82.88} yrs (extreme retro outliers)
    \end{itemize}
\end{frame}

\begin{frame}{Validation: Detecting "Time Travelers"}
    We validated the index on tracks known for their retro aesthetic.
    
    \begin{table}[]
        \centering
        \small
        \begin{tabular}{ll ccc}
            \toprule
            \textbf{Song} & \textbf{Year} & \textbf{Predicted} & \textbf{Index} & \textbf{Diagnosis} \\
            \midrule
            \textit{Uptown Funk} (Ronson) & 2015 & 2013.1 & \textbf{1.9} & Modern Construction \\
            \rowcolor{yellow!20} \textit{Physical} (Dua Lipa) & 2020 & 2009.0 & \textbf{11.0} & \textbf{Retro Aesthetic} \\
            \rowcolor{red!10} \textit{Blinding Lights} (Weeknd) & 2019 & 2004.2 & \textbf{14.8} & \textbf{80s Revival} \\
            \bottomrule
        \end{tabular}
    \end{table}
    
    \vspace{0.3cm}
    \textbf{Conclusion}: The model correctly identifies these hits as "sounding old", proving it captures aesthetic style rather than just memorizing release dates.
\end{frame}

\begin{frame}{Conclusion}
    \Large
    \begin{enumerate}
        \item \textbf{Recognition}: We can date music to within $\pm 9$ years purely from audio.
        \item \textbf{Rigor}: Diagnostics proved OLS is insufficient; WLS is required.
        \item \textbf{Insight}: Musical evolution is quantifiable.
        \item \textbf{Value}: The Nostalgia Index provides a commercial metric for "Vibe".
    \end{enumerate}
    
    \vspace{1cm}
    \centering
    \textbf{Thank You.}
\end{frame}

\end{document}
